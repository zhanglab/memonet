## This file gives details of each script, in order of use:

download.sh: download MEMONET data
QCthresholds.r: determine QC thresholds for dataset preprocessing based on violin plots of QC metrics
mapping_OA.r: map MEMONET data to AIBS data
mapping_test1.r: test the accuracy of the mapping pipeline on AIBS dataset; map 25% of AIBS data onto remaining 75%, 100 times
mapping_test2.r: combine the 100 prediction_score_*.csv files from mapping_test1.r into one file
mapping_test3.r: summarize test results; compare mean and median scores of the test results and OA mapping results
prediction_score_cutoff_barcodes: generate barcode lists of L2/3 cells based on various prediction score cutoff values
DESCnormalization: normalize L2/3 counts
celltype_contaminants: calculate mean expression of marker genes for cells removed at each prediciton score cutoff, to determine which cutoff removes glial contaminants
dataset_descriptions.r: compare cell type proportions of AIBS and MEMONET datasets; generate barcode lists for GABAergic and glutamatergic neurons; 
statistics.r: calculate significance of train and control proportion mapped to the AIBS L2/3 subtypes, and later for train and control mapped to clusters
DESC_inputFormat.r: subset L2/3 normalized counts to EDGs
DESC_EDGclustering_loop.py: cluster using EDG-subset genelist using various combinations of DESC parameters and calculate silhouette scores of cluster results
DESCparameterSummary.r: calculate avererage silhouette score per clustering result
sil_score_smooth.py: run a smoothing algorithm on the silhouette scores to find what parameter combination gives the peak score; we choose the parameter values at the peak for running DESC clustering
DESC_EDGclustering.py: cluster using EDG-subset genelist using the chosen parameter values
classifier_umap_plot: visualize clusters
GOvisualization.r: run Gene Ontology analysis on the 3000 EDGs and later on the upregulated DEGs of the clusters
DESeq2_tr_vs_ctrl.r: DE analysis of all glut, GABA, or L2/3 neurons
genelist.r: summarize IEG significance from the DE analysis
DESeq2_clusterX_vs_others.r: DE analysis of one cluster vs others
DESeq2-table.r: combine result files for each cluster into a single file
DEGvisuals.r: visualize IEG significance results
mapping_AO.r: map AIBS L2/3 cells onto MEMONET clusters
DESeq2_clusterX_vs_clusterY.r: DE analysis of one cluster vs a specified reference cluster (C0)
reactivation_score.r: calculate reactivation potential of the clusters




